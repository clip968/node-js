<style>
  .message {
    width: 300px;
    color: #fff;
    background-color: purple;
    margin-top: 5px;
    padding: 5px;
  }
</style>

<body>
  <textarea id="message" rows="5" cols="50"></textarea>
  <br />

  <button onclick="sendMessage()">전송</button>
  <button onclick="websocketClose()">종료</button>
  <div id="messages"></div>
</body>

<script>
  const ws = new WebSocket("ws://localhost:3000");

  function sendMessage() {
    ws.send(document.getElementById("message").value);
  }

  function websocketClose() {
    console.log("웹소켓 종료");
    ws.close();
  }

  ws.onopen = function () {
    console.log("웹소켓 연결 완료");
  };

  ws.onmessage = function (event) {
    let message = event.data.replace(/(\r\n|\n|\r)/g, "<br />");
    let element = document.createElement("div");
    element.innerHTML = message;
    element.className = "message";
    document.getElementById("messages").appendChild(element);
  };

  ws.onclose = function (e) {
    console.log("웹소켓 연결 해제");
    document.getElementById("message").append("서버 접속 종료");
  };
</script>
